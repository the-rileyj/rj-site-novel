version: '3'
services:
    ghost:
        image: ghost:latest
        restart: always
        depends_on:
            - db
        environment:
            url: http://localhost:2099
            database__client: mysql
            database__connection__host: db
            database__connection__user: root
            database__connection__password: root
            database__connection__database: ghost
        volumes:
            - ./content:/var/lib/ghost/content

    db:
        image: mysql:5.7
        ports:
            - 3306:3306
        restart: always
        environment:
            MYSQL_ROOT_PASSWORD: root
        volumes:
            - ./mysql:/var/lib/mysql

    nginx:
        image: nginx:latest
        restart: always
        depends_on:
            - ghost
        ports:
            - '2099:80'
        volumes:
            - ./nginx/dev.conf:/etc/nginx/conf.d/default.conf
